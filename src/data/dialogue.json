{
  "beryl_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome to Beryl's General Goods!",
        "player_choices": [
          { "text": "Show me your goods.", "closes_dialogue": true, "action": "open_shop:beryls_general_goods" },
          { "text": "Finn sent me. Pay 10 silvers.", "action": "collect_debt_from:npc_beryl", "closes_dialogue": true, "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false" },
          { "text": "Goodbye, Beryl.", "closes_dialogue": true }
        ]
      }
    }
  },
  "beryl_tavern": {
    "nodes": {
      "0": {
        "npc_text": "Off the clock tonight."
        ,
        "player_choices": [
          { "text": "Finn sent me. Pay 10 silvers.", "action": "collect_debt_from:npc_beryl", "closes_dialogue": true, "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false" },
          { "text": "Goodbye, Beryl.", "closes_dialogue": true }
        ]
      }
    }
  },
  "kaelen_default": {
    "nodes": {
      "0": {
        "npc_text": "The forge is hot today. What brings you here?",
        "player_choices": [ { "text": "Goodbye, Kaelen.", "closes_dialogue": true } ]
      }
    }
  },
  "cyrus_default": {
    "nodes": {
      "0": {
        "npc_text": "I'm Cyrus, apprentice to Kaelen. Need something forged?",
        "player_choices": [ { "text": "Goodbye, Cyrus.", "closes_dialogue": true } ]
      }
    }
  },
  "adalia_default": {
    "nodes": {
      "0": {
        "npc_text": "Ah, a visitor to the library.",
        "player_choices": [ { "text": "Goodbye, Adalia.", "closes_dialogue": true } ]
      }
    }
  },
  "matthias_default": {
    "nodes": {
      "0": {
        "npc_text": "Halt! What business do you have at Mosswatch Keep?",
        "player_choices": [
          {
            "text": "I'm looking for work.",
            "next_node": "1"
          }
        ]
      },
      "1": {
        "npc_text": "Try Sergeant Rodrick in the Tidehunter Quarter.",
        "player_choices": [ { "text": "Back", "next_node": "0" } ]
      }
    }
  },
  "rodrick_default": {
    "nodes": {
      "0": {
        "npc_text": "What do you want, kid?",
        "player_choices": [
          {
            "text": "I heard about a wolf problem.",
            "next_node": "1",
            "action": "start_quest:rodrick_wolf_pack",
            "closes_dialogue": true
          }
        ]
      },
      "1": {
        "npc_text": "Talk to the hunter in the woods.",
        "player_choices": [ { "text": "Back", "next_node": "0" } ]
      }
    }
  },
  "boric_intro": {
    "nodes": {
      "0": {
        "npc_text": "Oh, a new face. I haven’t seen you on the docks yet, I know everyone that comes through. Name’s Boric, by the way.",
        "player_choices": [
          { "text": "I’m looking for work.", "next_node": "bi_work", "condition": "relationship.npc_boric>=-50" },
          { "text": "I’m looking for work.", "next_node": "bi_refuse", "condition": "relationship.npc_boric<-50" },
          { "text": "I’ll leave you to it.", "closes_dialogue": true }
        ]
      },
      "bi_work": {
        "npc_text": "Dockhands haul crates, lash lines, and mind the tide. Twenty copper a shift. Hours are eight to four, weekdays. Be here before the horn, and don’t make me regret putting your name in the ledger.",
        "player_choices": [
          { "text": "Hire me.", "action": "hire_job:job_dockhand", "closes_dialogue": true },
          { "text": "Not now.", "closes_dialogue": true }
        ]
      },
      "bi_refuse": {
        "npc_text": "Get off my pier. I don’t hire dead weight.",
        "player_choices": [ { "text": "I’ll leave you to it.", "closes_dialogue": true } ]
      }
    }
  },
  "boric_default": {
    "nodes": {
      "0": {
        "npc_text": "Harbor’s loud today. What do you need?",
        "player_choices": [
          { "text": "I’m looking for work.", "next_node": "bd_work", "condition": "relationship.npc_boric>=-50" },
          { "text": "I’m looking for work.", "next_node": "bd_refuse", "condition": "relationship.npc_boric<-50" },
          { "text": "I’ll leave you to it.", "closes_dialogue": true }
        ]
      },
      "bd_work": {
        "npc_text": "Twenty copper a shift, eight to four, weekdays. Show up before the horn.",
        "player_choices": [
          { "text": "Hire me.", "action": "hire_job:job_dockhand", "closes_dialogue": true },
          { "text": "Not now.", "closes_dialogue": true }
        ]
      },
      "bd_refuse": {
        "npc_text": "Get off my pier. I don’t hire dead weight.",
        "player_choices": [ { "text": "I’ll leave you to it.", "closes_dialogue": true } ]
      }
    }
  },
  "boric_employee": {
    "nodes": {
      "0": {
        "npc_text": "You’re on my ledger. Keep showing up and keep your hands steady.",
        "player_choices": [ { "text": "I’ll leave you to it.", "closes_dialogue": true } ]
      }
    }
  },
  "boric_fired": {
    "nodes": {
      "0": {
        "npc_text": "We tried you. Missed days or didn’t cut it. You’re off the roster.",
        "player_choices": [
          { "text": "Can you give me the job back?", "action": "try_hire_or_deny:job_dockhand:bf_deny" },
          { "text": "I’ll leave you to it.", "closes_dialogue": true }
        ]
      },
      "bf_deny": { "npc_text": "No.", "player_choices": [ { "text": "Understood.", "closes_dialogue": true } ] }
    }
  },
  "elias_default": {
    "nodes": {
      "0": {
        "npc_text": "Ahoy! Captain Elias at your service. What tales do you bring?",
        "player_choices": [ { "text": "Goodbye, Captain Elias.", "closes_dialogue": true } ]
      }
    }
  },
  "roberta_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome. Tide & Trade is a bit battered today. What can I do for you?",
        "player_choices": [
          { "text": "What's for sale?", "closes_dialogue": true, "action": "open_shop:tide_and_trade" },
          { "text": "What happened to the wall?", "next_node": "rb_wall", "condition": "quest.roberta_planks_for_the_past.active==false && quest.roberta_planks_for_the_past.completed==false" },
          { "text": "Tell me about Tide & Trade.", "next_node": "rb_lore_tide_trade1", "condition": "world_flags.roberta_lore_seen==false" },
          { "text": "I'll come back later.", "closes_dialogue": true }
        ]
      },
      "rb_wall": {
        "npc_text": "A storm carved a hole through the side. I need planks to brace and patch it before the next squall.",
        "player_choices": [
          { "text": "Can I help with the repairs?", "next_node": "rb_help_gate" },
          { "text": "How do I get planks?", "next_node": "rb_hint_planks" },
          { "text": "Back to counter", "next_node": "0" }
        ]
      },
      "rb_help_gate": {
        "npc_text": "I'd be grateful. Repairs take trust and care.",
        "player_choices": [
          { "text": "I'll help. Let's start the repairs.", "action": "start_quest:roberta_planks_for_the_past", "condition": "relationship.npc_roberta>=20", "closes_dialogue": true },
          { "text": "Can I help now?", "next_node": "rb_gate_refusal", "condition": "relationship.npc_roberta<20" },
          { "text": "Back to counter", "next_node": "0" }
        ]
      },
      "rb_gate_refusal": {
        "npc_text": "I don't know you well enough to rely on you yet. Maybe another time.",
        "player_choices": [ { "text": "I understand.", "next_node": "0" } ]
      },
      "rb_hint_planks": {
        "npc_text": "Cut logs in the woods, then use the sawmill to make planks. Crawler runs it: two copper per plank.",
        "player_choices": [ { "text": "Back to counter", "next_node": "0" } ]
      },
      "rb_lore_tide_trade1": {
        "npc_text": "Tide & Trade is one of Driftwatch’s oldest shops. It’s stood through lean years and storms.",
        "player_choices": [ { "text": "And your family?", "next_node": "rb_lore_tide_trade2" } ]
      },
      "rb_lore_tide_trade2": {
        "npc_text": "My father ran it for decades. He passed recently… I'm still learning to handle everything.",
        "player_choices": [ { "text": "Back to counter", "next_node": "0", "action": "set_flag:roberta_lore_seen:true" } ]
      }
    }
  },
  "roberta_planks_active": {
    "nodes": {
      "0": {
        "npc_text": "Any progress on the planks?",
        "player_choices": [
          { "text": "How do I get planks again?", "next_node": "1" },
          { "text": "I brought the planks.", "next_node": "reward", "action": "advance_quest_stage:roberta_planks_for_the_past", "condition": "quest.roberta_planks_for_the_past.stage==3" },
          { "text": "What's for sale?", "action": "open_shop:tide_and_trade", "closes_dialogue": true },
          { "text": "I'll come back later.", "closes_dialogue": true }
        ]
      },
      "1": {
        "npc_text": "Cut logs in the woods, then use the sawmill to make planks. I'll brace the wall once you have them.",
        "player_choices": [ { "text": "Back to counter", "next_node": "0" } ]
      },
      "reward": {
        "npc_text": "Thank you. This will hold. Here's your payment.",
        "player_choices": [ { "text": "Back to counter", "next_node": "0", "action": "complete_quest:roberta_planks_for_the_past" } ]
      }
    }
  },
  "roberta_planks_completed": {
    "nodes": {
      "0": {
        "npc_text": "The patch held through the last squall. I couldn’t have done it without you.",
        "player_choices": [
          { "text": "What's for sale?", "action": "open_shop:tide_and_trade", "closes_dialogue": true },
          { "text": "Tell me about Tide & Trade.", "next_node": "tide_trade_lore", "condition": "world_flags.roberta_lore_seen==false" },
          { "text": "I'll come back later.", "closes_dialogue": true }
        ]
      }
    }
  },
  "finn_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome to the Salty Mug.",
        "player_choices": [
          { "text": "Let me see your stock.", "action": "open_shop:salty_mug", "closes_dialogue": true },
          { "text": "About the collection job.", "next_node": "job_progress", "condition": "world_flags.finn_debt_collection_active==true" },
          { "text": "Leave.", "closes_dialogue": true, "condition": "world_flags.finn_debt_collection_active==true" }
        ]
      },
      "job_progress": {
        "npc_text": "Three names. Ten silvers each. Bring me thirty when you're done.",
        "player_choices": [
          { "text": "Turn in 30 silvers.", "action": "turn_in_debt_or_rebuke:30:jd_rebuke", "next_node": "jd_rebuke" },
          { "text": "I'll get back to it.", "closes_dialogue": true }
        ]
      },
      "jd_rebuke": {
        "npc_text": "Come back when you have the silver, kid.",
        "player_choices": [ { "text": "Leave.", "closes_dialogue": true } ]
      }
    }
  },
  "finn_debt_intro": {
    "nodes": {
      "0": {
        "npc_text": "Pay up.",
        "player_choices": [
          { "text": "I'll pay up.", "next_node": "math", "action": "set_flag:finn_debt_intro_pending:false" },
          { "text": "I don't have the money.", "next_node": "math", "action": "set_flag:finn_debt_intro_pending:false" },
          { "text": "Please, give me a chance.", "next_node": "math", "action": "set_flag:finn_debt_intro_pending:false" }
        ]
      },
      "math": {
        "npc_text": "Three months at twenty copper a day. Eighteen silvers you owe, and you don't have it. Here's a job: make three pay for you: Ben at the farm, Beryl at General Goods, and Elara in her hovel. Ten silvers from each. Thirty days. Bring me thirty silvers.",
        "player_choices": [
          { "text": "I accept.", "action": "start_quest:finn_debt_collection|start_debt_collection", "closes_dialogue": true },
          { "text": "No choice. I'll do it.", "action": "start_quest:finn_debt_collection|start_debt_collection", "closes_dialogue": true }
        ]
      }
    }
  },
  "old_crank_default": {
    "nodes": {
      "0": {
        "npc_text": "Bah! Another whelp in the tavern.",
        "player_choices": [ { "text": "Ignore him.", "closes_dialogue": true } ]
      }
    }
  },
  "elara_default": {
    "nodes": {
      "0": {
        "npc_text": "Herbs and potions, stranger.",
        "player_choices": [
          { "text": "Goodbye, Elara.", "closes_dialogue": true },
          { "text": "Finn sent me. Pay 10 silvers.", "action": "collect_debt_from:npc_elara", "closes_dialogue": true, "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_elara==false" }
        ]
      }
    }
  },
  "crawler_default": {
    "nodes": {
      "0": {
        "npc_text": "Logs to planks? 2 copper per plank.",
        "player_choices": [
          {
            "text": "Can I use your sawmill?",
            "next_node": "unlock",
            "condition": "world_flags.sawmill_unlocked==false"
          },
          { "text": "Leave.", "closes_dialogue": true }
        ]
      },
      "unlock": {
        "npc_text": "You can. Two copper per plank. Use the sawmill outside.",
        "player_choices": [
          { "text": "Thanks.", "closes_dialogue": true, "action": "set_flag:sawmill_unlocked:true" }
        ]
      },
      "thanks": { "npc_text": "Right.", "player_choices": [ { "text": "Leave.", "closes_dialogue": true } ] }
    }
  },
  "ronald_default": {
    "nodes": {
      "0": {
        "npc_text": "The woods are dangerous. What brings you?",
        "player_choices": [
          {
            "text": "About the wolves...",
            "next_node": "1",
            "closes_dialogue": true
          }
        ]
      },
      "1": {
        "npc_text": "I can help hunt them, but I want half the reward.",
        "player_choices": [
          {
            "text": "Deal.",
            "next_node": "2",
            "action": "recruit_companion:companion_ronald",
            "closes_dialogue": true
          },
          {
            "text": "No thanks.",
            "next_node": "3",
            "closes_dialogue": true
          }
        ]
      },
      "2": {
        "npc_text": "Let's go.",
        "player_choices": []
      },
      "3": {
        "npc_text": "Your loss.",
        "player_choices": []
      }
    }
  },
  "ben_default": {
    "nodes": {
      "0": {
        "npc_text": "Hard work on the farm. What can I do for you?",
        "player_choices": [
          { "text": "Goodbye, Ben.", "closes_dialogue": true },
          { "text": "Finn sent me. Pay 10 silvers.", "action": "collect_debt_from:npc_ben", "closes_dialogue": true, "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_ben==false" }
        ]
      }
    }
  },
  "elisa_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome to the farm.",
        "player_choices": [ { "text": "Goodbye, Elisa.", "closes_dialogue": true } ]
      }
    }
  },
  "rowan_default": {
    "nodes": {
      "0": {
        "npc_text": "I'm Rowan. What?",
        "player_choices": [ { "text": "Goodbye, Rowan.", "closes_dialogue": true } ]
      }
    }
  },
  "old_leo_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome home, child.",
        "player_choices": [
          { "text": "Hey Leo, can you remind me of the story of the lighthouse?", "next_node": "lighthouse_lore" },
          { "text": "Goodbye, Leo.", "closes_dialogue": true }
        ]
      },
      "1": {
        "npc_text": "Stay safe.",
        "player_choices": [ { "text": "Back", "next_node": "0" } ]
      },
      "lighthouse_lore": {
        "npc_text": "Years ago, a great fire swept Driftwatch, burning nearly forty percent of the town. The orphanage, our lighthouse, was among the places caught in the blaze. A man named Leo carried sixteen children to safety, giving his own life to save them. That is why he is remembered as a Son of the Moon.",
        "player_choices": [
          { "text": "Who are the Sons of the Moon?", "next_node": "sons_moon" },
          { "text": "Thank you, Leo.", "closes_dialogue": true, "action": "set_flag:leo_lighthouse_history_seen:true" }
        ]
      },
      "sons_moon": {
        "npc_text": "They are heroes the Moon speaks to called in hard times to guide and protect, so people can endure and pass through their trials.",
        "player_choices": [
          { "text": "Thank you.", "closes_dialogue": true, "action": "set_flag:leo_sons_of_the_moon_seen:true" }
        ]
      }
    }
  },
  "sarah_default": {
    "nodes": {
      "0": {
        "npc_text": "Hi Luke!",
        "player_choices": [ { "text": "See you soon, Sarah.", "closes_dialogue": true } ]
      }
      
    }
  },
  "robert_default": {
    "nodes": {
      "0": {
        "npc_text": "Hey Luke.",
        "player_choices": [ { "text": "See you soon, Robert.", "closes_dialogue": true } ]
      }
      
    }
  },
  "kyle_default": {
    "nodes": {
      "0": {
        "npc_text": "Luke!",
        "player_choices": [ { "text": "See you soon, Kyle.", "closes_dialogue": true } ]
      }
      
    }
  }
  ,
  "old_leo_intro": {
    "nodes": {
      "0": {
        "npc_text": "Good morning, Luke. I waited at the door last night and you did not come until the lamps burned low. Tell me, what kept you so long?",
        "player_choices": [
          { "text": "I lingered at the canals, practicing with the nets.", "next_node": "fish", "action": "grant_skill_level:fishing:5" },
          { "text": "I stayed on the street speaking with Roberta.", "next_node": "roberta", "action": "grant_skill_level:persuasion:3|set_flag:intro_spoke_roberta:true|set_relationship:npc_roberta:20|add_known_npc:npc_roberta" },
          { "text": "I was drawn into a fight with a noble boy.", "next_node": "fight" }
        ]
      },
      "fish": {
        "npc_text": "Diligence at the water is an honest answer. The canals can teach a careful hand. Still, do not keep the orphanage waiting again. Go and take your breakfast, and return with a steadier habit.",
        "player_choices": [
          { "text": "Yes, Leo.", "closes_dialogue": true }
        ]
      },
      "roberta": {
        "npc_text": "Words well placed can mend more than boards. Roberta is a good sort; keep good company, and mind your hours. Go now and eat before the day runs ahead of you.",
        "player_choices": [
          { "text": "Yes, Leo.", "closes_dialogue": true }
        ]
      },
      "fight": {
        "npc_text": "No more brawling, Luke. Pride is a poor meal and trouble is quick to follow it. If you wish to stand tall, do so in your work. Go and take your breakfast, and do not be late again.",
        "player_choices": [
          { "text": "Yes, Leo.", "closes_dialogue": true }
        ]
      }
    }
  },
  "sarah_intro": {
    "nodes": {
      "0": {
        "npc_text": "Hi Luke! Want to help me later?",
        "player_choices": [
          { "text": "Let's play.", "closes_dialogue": true, "action": "set_flag:played_midday:true|update_relationship:npc_sarah:10" },
          { "text": "Talk to you later.", "closes_dialogue": true }
        ]
      }
    }
  },
  "robert_intro": {
    "nodes": {
      "0": {
        "npc_text": "Luke, think we can team up sometime?",
        "player_choices": [
          { "text": "Let's play.", "closes_dialogue": true, "action": "set_flag:played_midday:true|update_relationship:npc_robert:10" },
          { "text": "Talk to you later.", "closes_dialogue": true }
        ]
      }
    }
  }
}
