{
  "beryl_default": {
    "nodes": {
      "0": {
        "npc_text": "Welcome to Beryl's General Goods! What do you need?",
        "player_choices": [
          {
            "text": "Show me your goods.",
            "action": "open_shop:beryls_general_goods"
          },
          {
            "text": "About that letter...",
            "next_node": "beryl_confrontation",
            "condition": "world_flags.beryl_letter_found==true && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "Finn sent me. Pay 10 silvers.",
            "next_node": "beryl_refusal",
            "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false && world_flags.beryl_refused_debt==false && world_flags.beryl_letter_found==false && world_flags.beryl_help_agreed==false && inventory.beryl_noble_parcel==0"
          },
          {
            "text": "Finn sent me. Pay 10 silvers.",
            "next_node": "beryl_refusal_repeat",
            "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false && world_flags.beryl_refused_debt==true && world_flags.beryl_letter_found==false && world_flags.beryl_help_agreed==false && inventory.beryl_noble_parcel==0"
          },
          {
            "text": "Goodbye, Beryl.",
            "closes_dialogue": true
          }
        ]
      },
      "beryl_refusal": {
        "npc_text": "I... I can't! Business has been slow... please, tell Finn I need more time!",
        "player_choices": [
          {
            "text": "He wants it now.",
            "next_node": "beryl_refusal_2"
          },
          {
            "text": "Is there any other way?",
            "next_node": "beryl_help_offer"
          },
          {
            "text": "I'll see what I can do.",
            "closes_dialogue": true,
            "action": "set_flag:beryl_refused_debt:true"
          }
        ]
      },
      "beryl_help_offer": {
        "npc_text": "Well... there is one thing. I have a discreet package that needs to go to a client in the Noble Quarter. Deliver it, and I'll consider the debt paid.",
        "player_choices": [
          {
            "text": "I'll do it.",
            "action": "add_item:beryl_noble_parcel:1|set_flag:beryl_help_agreed:true",
            "closes_dialogue": true,
            "condition": "inventory.beryl_noble_parcel==0 && world_flags.beryl_delivery_done==false && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "No.",
            "closes_dialogue": true
          }
        ]
      },
      "beryl_refusal_2": {
        "npc_text": "I don't have it! Leave me alone!",
        "player_choices": [
          {
            "text": "Listen, old man... pay up or else.",
            "next_node": "beryl_pay_intimidate",
            "req_skill_level": {
              "skill": "coercion",
              "level": 10
            }
          },
          {
            "text": "Fine.",
            "closes_dialogue": true,
            "action": "set_flag:beryl_refused_debt:true"
          }
        ]
      },
      "beryl_refusal_repeat": {
        "npc_text": "I told you, I don't have it! Go away!",
        "player_choices": [
          {
            "text": "Listen, old man... pay up or else.",
            "next_node": "beryl_pay_intimidate",
            "req_skill_level": {
              "skill": "coercion",
              "level": 10
            }
          },
          {
            "text": "Leave.",
            "closes_dialogue": true
          }
        ]
      },
      "beryl_pay_intimidate": {
        "npc_text": "A-alright! Don't hurt me! Here's the money! Just go!",
        "player_choices": [
          {
            "text": "Smart choice.",
            "closes_dialogue": true,
            "action": "collect_debt_from:npc_beryl|add_xp:coercion:25|update_relationship:npc_beryl:-30|set_flag:beryl_intimidated:true"
          }
        ]
      },
      "beryl_pay_intimidate_fail": {
        "npc_text": "You... you don't scare me! Get out before I call the guards!",
        "player_choices": [
          {
            "text": "Hmph.",
            "closes_dialogue": true
          }
        ]
      },
      "beryl_confrontation": {
        "npc_text": "What? That letter... where did you get that?! Give it here!",
        "player_choices": [
          {
            "text": "Pay the debt (10 Silvers).",
            "next_node": "beryl_pay_debt"
          },
          {
            "text": "Pay the debt + 50 Coppers for my trouble.",
            "next_node": "beryl_pay_extra"
          }
        ]
      },
      "beryl_pay_debt": {
        "npc_text": "Fine! Here is the money for Finn. Now give me that letter!",
        "player_choices": [
          {
            "text": "Pleasure doing business.",
            "closes_dialogue": true,
            "action": "collect_debt_from:npc_beryl|remove_item:beryl_noble_letter:1|add_xp:coercion:20|update_relationship:npc_beryl:-10"
          }
        ]
      },
      "beryl_pay_extra": {
        "npc_text": "You greedy little... Fine! Take it! And never come back!",
        "player_choices": [
          {
            "text": "Pleasure doing business.",
            "closes_dialogue": true,
            "action": "collect_debt_from:npc_beryl|add_money:50|remove_item:beryl_noble_letter:1|add_xp:coercion:40|update_relationship:npc_beryl:-20"
          }
        ]
      }
    }
  },
  "beryl_tavern": {
    "nodes": {
      "0": {
        "npc_text": "Off the clock tonight.",
        "player_choices": [
          {
            "text": "I delivered the package.",
            "next_node": "delivery_reward",
            "condition": "world_flags.beryl_delivery_done==true && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "Finn sent me. Pay 10 silvers.",
            "next_node": "tavern_refusal",
            "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false && world_flags.beryl_help_agreed==false && inventory.beryl_noble_parcel==0"
          },
          {
            "text": "About that letter...",
            "next_node": "tavern_blackmail",
            "condition": "world_flags.beryl_letter_found==true && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "Goodbye, Beryl.",
            "closes_dialogue": true
          }
        ]
      },
      "tavern_refusal": {
        "npc_text": "Not here, kid. I'm trying to enjoy my ale. Come by the shop in the morning.",
        "player_choices": [
          {
            "text": "Fine.",
            "closes_dialogue": true
          }
        ]
      },
      "tavern_blackmail": {
        "npc_text": "You found it? Shh! Not so loud! Fine, take the money, just give it to me!",
        "player_choices": [
          {
            "text": "Pleasure doing business.",
            "closes_dialogue": true,
            "action": "collect_debt_from:npc_beryl|remove_item:beryl_noble_letter:1|add_xp:coercion:20|update_relationship:npc_beryl:-10"
          }
        ]
      },
      "delivery_reward": {
        "npc_text": "Excellent work. The client was satisfied? Good. Here is the coin for Finn.",
        "player_choices": [
          {
            "text": "Take the money.",
            "action": "collect_debt_from:npc_beryl",
            "closes_dialogue": true
          }
        ]
      }
    }
  },
  "beryl_debt_approach": {
    "nodes": {
      "0": {
        "npc_text": "Welcome to Beryl's General Goods!",
        "player_choices": [
          {
            "text": "Show me your goods.",
            "closes_dialogue": true,
            "action": "open_shop:beryls_general_goods"
          },
          {
            "text": "I delivered the package.",
            "next_node": "delivery_reward",
            "condition": "world_flags.beryl_delivery_done==true && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "Finn sent me. Pay 10 silvers.",
            "next_node": "debt_confrontation",
            "condition": "world_flags.finn_debt_collection_active==true && world_flags.debt_paid_by_beryl==false && world_flags.beryl_help_agreed==false && inventory.beryl_noble_parcel==0"
          },
          {
            "text": "Goodbye, Beryl.",
            "closes_dialogue": true
          }
        ]
      },
      "debt_confrontation": {
        "npc_text": "Ten silvers? That's a lot of money. What are my options?",
        "player_choices": [
          {
            "text": "Maybe I can help with something?",
            "next_node": "soft_approach",
            "condition": "world_flags.beryl_soft_approach_started==false"
          },
          {
            "text": "I found this interesting letter...",
            "next_node": "hard_approach",
            "condition": "inventory.beryl_noble_letter>0 && world_flags.beryl_hard_approach_started==false"
          },
          {
            "text": "Just pay up or else.",
            "action": "collect_debt_from:npc_beryl",
            "closes_dialogue": true
          },
          {
            "text": "I'll come back later.",
            "closes_dialogue": true
          }
        ]
      },
      "soft_approach": {
        "npc_text": "Chores? No... but I do have a delicate matter. I need a package delivered to a customer in the Noble Quarter. A... discreet package.",
        "player_choices": [
          {
            "text": "I'll deliver it.",
            "action": "add_item:beryl_noble_parcel:1|set_flag:beryl_help_agreed:true",
            "closes_dialogue": true,
            "condition": "inventory.beryl_noble_parcel==0 && world_flags.beryl_delivery_done==false && world_flags.debt_paid_by_beryl==false"
          },
          {
            "text": "Actually, let me think about it.",
            "closes_dialogue": true
          }
        ]
      },
      "hard_approach": {
        "npc_text": "A letter? What kind of letter?",
        "player_choices": [
          {
            "text": "A letter about you and a certain noble woman...",
            "action": "set_flag:beryl_hard_approach_started:true|remove_item:beryl_noble_letter:1|update_relationship:npc_beryl:-20",
            "next_node": "blackmail_result"
          },
          {
            "text": "Never mind.",
            "closes_dialogue": true
          }
        ]
      },
      "blackmail_result": {
        "npc_text": "You... you found that? Fine! Take your ten silvers and leave me be!",
        "player_choices": [
          {
            "text": "Pleasure doing business.",
            "action": "collect_debt_from:npc_beryl",
            "closes_dialogue": true
          }
        ]
      },
      "delivery_reward": {
        "npc_text": "Excellent work. The client was satisfied? Good. Here is the coin for Finn.",
        "player_choices": [
          {
            "text": "Take the money.",
            "action": "collect_debt_from:npc_beryl",
            "closes_dialogue": true
          }
        ]
      }
    }
  }
}
