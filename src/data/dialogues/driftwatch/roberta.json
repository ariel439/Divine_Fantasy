{
  "roberta_default": {
    "nodes": {
      "0": {
        "npc_text": "Tide & Trade, finest goods in Port Kael. What can I get you?",
        "player_choices": [
          {
            "text": "What's for sale?",
            "action": "open_shop:tide_and_trade"
          },
          {
            "text": "What happened to the wall?",
            "next_node": "rb_wall",
            "condition": "quest.roberta_planks_for_the_past.active==false && quest.roberta_planks_for_the_past.completed==false"
          },
          {
            "text": "How is the wall repair going?",
            "next_node": "rb_help_gate",
            "condition": "quest.roberta_planks_for_the_past.active==true && quest.roberta_planks_for_the_past.stage == 1 && inventory.wooden_plank < 10"
          },
          {
            "text": "I have the planks.",
            "next_node": "rb_give_materials",
            "condition": "quest.roberta_planks_for_the_past.active==true && inventory.wooden_plank >= 10 && quest.roberta_planks_for_the_past.stage <= 2"
          },
          {
            "text": "I have the materials.",
            "next_node": "rb_materials_check",
            "condition": "quest.roberta_planks_for_the_past.active==true && quest.roberta_planks_for_the_past.stage == 3"
          },
          {
            "text": "I repaired the wall.",
            "action": "complete_quest:roberta_planks_for_the_past",
            "next_node": "rb_quest_complete",
            "condition": "quest.roberta_planks_for_the_past.active==true && quest.roberta_planks_for_the_past.stage == 4"
          },
          {
            "text": "Tell me about Tide & Trade.",
            "next_node": "rb_lore_tide_trade1",
            "condition": "world_flags.roberta_lore_seen==false"
          },
          {
            "text": "Goodbye, Roberta.",
            "closes_dialogue": true
          }
        ]
      },
      "rb_wall": {
        "npc_text": "The storm took a chunk out of the east storehouse. I need planks to patch it before the next high tide.",
        "player_choices": [
          {
            "text": "I can help with that.",
            "next_node": "rb_help_gate",
            "condition": "relationship.npc_roberta>=20"
          },
          {
            "text": "I can help with that.",
            "next_node": "rb_trust_refusal",
            "condition": "relationship.npc_roberta<20"
          },
          {
            "text": "Sorry to hear that. (Back)",
            "next_node": "0"
          }
        ]
      },
      "rb_trust_refusal": {
        "npc_text": "I appreciate the offer, but I don't know you well enough to trust you with my shop's repairs yet. Maybe stick around, trade a bit, and we'll see.",
        "player_choices": [
          {
            "text": "Understood. (Back)",
            "next_node": "0"
          }
        ]
      },
      "rb_help_gate": {
        "npc_text": "I'll pay you for the trouble. I need 10 Wood Planks. If you can bring me those, I'll provide the rest.",
        "player_choices": [
          {
            "text": "I'll find them.",
            "action": "start_quest:roberta_planks_for_the_past | set_quest_stage:roberta_planks_for_the_past:1",
            "next_node": "0",
            "condition": "quest.roberta_planks_for_the_past.active==false"
          },
          {
            "text": "I already have them.",
            "action": "start_quest:roberta_planks_for_the_past | set_quest_stage:roberta_planks_for_the_past:2",
            "next_node": "rb_give_materials",
            "condition": "quest.roberta_planks_for_the_past.active==false && inventory.wooden_plank >= 10"
          },
          {
            "text": "I'm still looking.",
            "next_node": "0",
            "condition": "quest.roberta_planks_for_the_past.active==true"
          }
        ]
      },
      "rb_give_materials": {
        "npc_text": "Good work getting these planks. Here, take these nails and a hammer I have lying around. Now go fix it.",
        "player_choices": [
          {
            "text": "I'll get to work.",
            "action": "add_item:iron_nails:20 | add_item:hammer:1 | set_quest_stage:roberta_planks_for_the_past:3",
            "closes_dialogue": true
          }
        ]
      },
      "rb_materials_check": {
        "npc_text": "The hole is on the east side. Use the hammer and nails I gave you to patch it up.",
        "player_choices": [
          {
            "text": "Right, I'm on it. (Back)",
            "next_node": "0"
          }
        ]
      },
      "rb_quest_complete": {
        "npc_text": "You did a fine job! The draft is gone. Here's your payment, as promised.",
        "player_choices": [
          {
            "text": "Glad I could help.",
            "next_node": "0"
          }
        ]
      },
      "rb_lore_tide_trade1": {
        "npc_text": "Tide & Trade is one of Driftwatch’s oldest shops. It’s stood through lean years and storms.",
        "player_choices": [
          {
            "text": "And your family?",
            "next_node": "rb_lore_tide_trade2"
          }
        ]
      },
      "rb_lore_tide_trade2": {
        "npc_text": "My father ran it for decades. He passed recently… I'm still learning to handle everything.",
        "player_choices": [
          {
            "text": "Back to counter",
            "next_node": "0",
            "action": "set_flag:roberta_lore_seen:true"
          }
        ]
      },
      "rb_lore_family": {
        "npc_text": "It's just me now. The shop is all I have left of them.",
        "player_choices": [
          {
            "text": "Back to counter",
            "next_node": "0"
          }
        ]
      }
    }
  },
  "roberta_planks_active": {
    "nodes": {
      "0": {
        "npc_text": "Any progress on the planks?",
        "player_choices": [
          {
            "text": "How do I get planks again?",
            "next_node": "1"
          },
          {
            "text": "I brought the planks.",
            "next_node": "rb_give_materials",
            "condition": "inventory.wooden_plank >= 10 && quest.roberta_planks_for_the_past.stage <= 2"
          },
          {
            "text": "I have the materials.",
            "next_node": "rb_materials_check",
            "condition": "quest.roberta_planks_for_the_past.stage == 3"
          },
          {
            "text": "I repaired the wall.",
            "action": "complete_quest:roberta_planks_for_the_past",
            "next_node": "rb_quest_complete",
            "condition": "quest.roberta_planks_for_the_past.stage == 4"
          },
          {
            "text": "What's for sale?",
            "action": "open_shop:tide_and_trade"
          },
          {
            "text": "Tell me about Tide & Trade.",
            "next_node": "rb_lore_tide_trade1",
            "condition": "world_flags.roberta_lore_seen==false"
          },
          {
            "text": "I'll come back later.",
            "closes_dialogue": true
          }
        ]
      },
      "1": {
        "npc_text": "Cut logs in the woods, then use the sawmill to make planks. I'll brace the wall once you have them.",
        "player_choices": [
          {
            "text": "Back to counter",
            "next_node": "0"
          }
        ]
      },
      "rb_give_materials": {
        "npc_text": "Good work getting these planks. Here, take these nails and a hammer I have lying around. Now go fix it.",
        "player_choices": [
          {
            "text": "I'll get to work.",
            "action": "add_item:iron_nail:20 | add_item:hammer:1 | set_quest_stage:roberta_planks_for_the_past:3",
            "closes_dialogue": true
          }
        ]
      },
      "rb_materials_check": {
        "npc_text": "The hole is on the east side. Use the hammer and nails I gave you to patch it up.",
        "player_choices": [
          {
            "text": "Right, I'm on it. (Back)",
            "next_node": "0"
          }
        ]
      },
      "rb_quest_complete": {
        "npc_text": "You did a fine job! The draft is gone. Here's your payment, as promised.",
        "player_choices": [
          {
            "text": "Glad I could help.",
            "next_node": "0"
          }
        ]
      },
      "rb_lore_tide_trade1": {
        "npc_text": "Tide & Trade is one of Driftwatch’s oldest shops. It’s stood through lean years and storms.",
        "player_choices": [
          {
            "text": "And your family?",
            "next_node": "rb_lore_tide_trade2"
          }
        ]
      },
      "rb_lore_tide_trade2": {
        "npc_text": "My father ran it for decades. He passed recently… I'm still learning to handle everything.",
        "player_choices": [
          {
            "text": "Back to counter",
            "next_node": "0",
            "action": "set_flag:roberta_lore_seen:true"
          }
        ]
      },
      "rb_lore_family": {
        "npc_text": "It's just me now. The shop is all I have left of them.",
        "player_choices": [
          {
            "text": "Back to counter",
            "next_node": "0"
          }
        ]
      }
    }
  },
  "roberta_planks_completed": {
    "nodes": {
      "0": {
        "npc_text": "The patch held through the last squall. I couldn’t have done it without you.",
        "player_choices": [
          {
            "text": "What's for sale?",
            "action": "open_shop:tide_and_trade"
          },
          {
            "text": "Tell me about Tide & Trade.",
            "next_node": "tide_trade_lore",
            "condition": "world_flags.roberta_lore_seen==false"
          },
          {
            "text": "I'll come back later.",
            "closes_dialogue": true
          }
        ]
      },
      "tide_trade_lore": {
        "npc_text": "This shop has been in my family for generations. We've weathered worse storms than this.",
        "player_choices": [
          {
            "text": "Good to hear. (Back)",
            "next_node": "0"
          }
        ]
      }
    }
  }
}
